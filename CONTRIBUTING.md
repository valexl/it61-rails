# Contribution Guide

Есть 2 способа развернуть и запустить проект:

- установить Ruby, Postgres локально и следовать инструкциям в [README.md](https://github.com/IT61/it61-rails/blob/master/README.md)
- установить Vagrant и развернуть окружение разработки через него (предпочтительный путь)

# Создание среды разработки при помощи Vagrant
Vagrant - это инструмент создания и конфигурирования виртуальной среды разработки. Является обёрткой для программного обеспечения виртуализации, например VirtualBox.

**Инструкция:**

- [для Windows](#windows-setup)
- TODO для Unix
- [для OS X](#osx-setup)

<a name="windows-setup" />
## Windows
**Важная особенность Git Bash:** команды нужно писать вручну, а не копировать из гайда, т.к. появляются недопустимые символы, которые приводят к ошибкам.
- устанавливаем [Vagrant](https://www.vagrantup.com)
- устанавливаем [MSysGit](https://git-for-windows.github.io) [(*)](#first)
- запускаем Git Bash (это адаптированный BASH shell для Windows)
- переходим в директорию, где будет ваш проект. Для смены диска используйте следующий синтаксис: `cd /БУКВА_ДИСКА/`
- клониурем репозиторий. Нам нужен бранч vagrant `git clone -b vagrant https://github.com/IT61/it61-rails.git`

<a name="osx-setup" />
## OS X

- устанавливаем [Homebrew](http://brew.sh)
- устанавливаем [Homebrew Cask](http://caskroom.io)
- устанавливаем Vagrant и VirtualBox: `brew cask install vagrant virtualbox`
- **или** устанавливаем Vagrant и VirtualBox вручную при помощи официальных установочных пакетов
- переходим к [основной инструкции](#general-setup)

<a name="general-setup" />
## Разворачиваем окружение для разработки

- командуем Vagrant провести первоначальную настройку виртуальной машины - `vagrant up`
- запускаем инициализацию и настройку проекта - `vagrant provision`
- если все прошло успешно, то вы должны увидеть следующую строчку:

```
==> default: all set, rock on!
```
- теперь подключаемся к машине при помощи SSH: `vagrant ssh`
- переходим в директорию с проектом: `cd /app`
- запускаем RoR сервер: `bundle exec rails s`
- у вас будет настроенное и запущенное приложение по адресу `localhost:3000`. В Vagrantfile уже настроена синхронизация между локальной копией проекта и копией виртуальной машине, т.е. все локальные изменения автоматически передаются в виртуальную машину.

Чтобы остановить/выключить машину, нужно выполнить следующую команду - `vagrant suspend`.
Для повторного запуска машины (допустим после перезагрузки вашей машины) нужно:
- **[только для Windows]** запустить Git bash
- перейти в директорию с локальной копией проекта
- запустить Vagrant: `vagrant up`
- подключиться к машине через SSH: `vagrant ssh`
- перейти в директорию с проектом: `cd /app`
- запустить веб-сервер RoR: `bundle exec rails s`

**ВАЖНО:** Чтобы Vagrant понимал для какой машины нужно выполнять команды, вы должны быть в директории с файлом `Vagrantfile`. В нашем случае это корневая директория проекта.

*Примечания:*

<a name="first" />
**[1]** MSysGit нужен для SSH, чтобы vagrant смог подключиться к виртуальной машине и выполнить команды. Особо упоротые клиенты могут использовать [нативный SSH клиент под Windows](https://github.com/PowerShell/Win32-OpenSSH)
